

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="Vitis, library, Database, Quantitative Finance, Vision, Data Compression, Security, Solver, BLAS, Hardware, xfOpenCV, xfdatabase, xffintech, xfcompression, xfsecurity, xfsolver, xfblas, xfhardware"/>
<meta name="description" content="Vitis software development platform includes an extensive set of open-source, performance-optimized libraries that offer out-of-the-box acceleration with minimal to zero-code changes to your existing applications, without the need to reimplement your algorithms from scratch to harness the benefits of Xilinx adaptive compute."/>
<meta name="xlnxdocumentclass" content="Document"> 
<meta name="xlnxdocumenttypes" content="Tutorials"> 
<!-- Header information provided by Emily-->
    <meta name="Language" content="en">
    <meta name="Location" content="us">
    <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
  
  <title>5. Build the PetaLinux Image &mdash; Versal Base TRD 2019.2-0.1.1 documentation</title>
  
<!-- Header information provided by Emily-->
    <meta name="apple-itunes-app" content="app-id=1063287962">
    <meta name="google-play-app" content="app-id=com.marketing.xilinxgo">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="https://kit.fontawesome.com/d3dd8c60ed.js"></script>
    
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all.min.css" type="text/css">
    
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css">
  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="4. Build the Vivado Design" href="build-vivado.html" /> 
</head>

<body class="wy-body-for-nav">
<div class="xilinx-bs3">
    <noindex>
        <header data-component="header">
            <nav class="navbar navbar-default">
                <div class="container main-nav">
                    <div class="row">
                        <div class="col-xs-5 col-sm-2 logo-column">
                            <div class="logo">
                                <a href="https://www.xilinx.com/">
                                    <img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc" />
                                </a>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 navbar-column">
                            <div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
                                <ul class="nav navbar-nav nav-justified">
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://www.xilinx.com/support.html#documentation">
                                            Documentation
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://www.xilinx.com/support.html">
                                            Support
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://forums.xilinx.com/">
                                            Forums
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="mini-nav col-sm-2">
                            <button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
        </header>
    </noindex>
</div>
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Versal Base TRD
          

          
          </a>

          
            
            
              <div class="version">
                0.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="revision.html">1. Revision History</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="run.html">3. Run the Prebuilt Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="build-vivado.html">4. Build the Vivado Design</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Build the PetaLinux Image</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">5.1. Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-flow-tutorial">5.2. Build Flow Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-an-sd-card-image">5.3. Create an SD Card Image</a></li>
</ul>
</li>
</ul>

            
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="_sources/build-plnx.rst.txt"
						rel="nofollow">Show Source</a></li>
					<li class="toctree-l1"><a href="https://gitenterprise.xilinx.com/PAEG/base-trd-jupyter/blob/master/docs/source/build-plnx.rst"
						   rel="nofollow">View on GitHub</a></li>						
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Versal Base TRD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>5. Build the PetaLinux Image</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/build-plnx.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="build-the-petalinux-image">
<h1>5. Build the PetaLinux Image<a class="headerlink" href="#build-the-petalinux-image" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prerequisites">
<h2>5.1. Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Reference Design zip file</p></li>
<li><p>PetaLinux Tools 2019.2</p></li>
<li><p>Linux host machine</p></li>
</ul>
</div>
<div class="section" id="build-flow-tutorial">
<h2>5.2. Build Flow Tutorial<a class="headerlink" href="#build-flow-tutorial" title="Permalink to this headline">¶</a></h2>
<p><strong>Download Reference Design Files</strong></p>
<p>Skip the following steps if the design zip file has already been downloaded and
extracted to a working directory</p>
<ol class="arabic simple">
<li><p>Download the VCK190 Base Targeted Reference Design ZIP file</p></li>
<li><p>Unzip Contents</p></li>
</ol>
<p>The directory structure is described in the Introduction Section.</p>
<p><strong>Generate PetaLinux Image</strong></p>
<ol class="arabic">
<li><p>Create a new PetaLinux project from the provided BSP:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">petalinux</span>
<span class="n">petalinux</span><span class="o">-</span><span class="n">create</span> <span class="o">-</span><span class="n">t</span> <span class="n">project</span> <span class="o">-</span><span class="n">s</span> <span class="n">xilinx</span><span class="o">-</span><span class="n">vck190</span><span class="o">-</span><span class="n">qspi</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="n">trd</span><span class="o">-</span><span class="mf">2019.2</span><span class="o">-</span><span class="n">v0</span><span class="o">.</span><span class="mf">1.1</span><span class="o">.</span><span class="n">bsp</span>
</pre></div>
</div>
</li>
<li><p>Configure and build the PetaLinux project.</p>
<p><strong>Note:</strong> The xsa file used for project configuration is included with this
BSP. The build step performs the configuration step implicitly. The xsa file
can be generated through Vivado following the Vivado build steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">xilinx</span><span class="o">-</span><span class="n">vck190</span><span class="o">-</span><span class="n">qspi</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="n">trd</span><span class="o">-</span><span class="mf">2019.2</span><span class="o">-</span><span class="n">v0</span><span class="o">.</span><span class="mf">1.1</span>
<span class="n">petalinux</span><span class="o">-</span><span class="n">build</span>
</pre></div>
</div>
</li>
<li><p>Create a boot image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">petalinux</span><span class="o">-</span><span class="n">package</span> <span class="o">--</span><span class="n">boot</span> <span class="o">--</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span>
</pre></div>
</div>
</li>
</ol>
<p>The resulting build artifacts will be available in the <em>petalinux/images/linux/</em>
folder. The relevant files for the next step are:</p>
<ul class="simple">
<li><p><strong>BOOT.BIN</strong>: This is the boot image which includes:</p>
<ul>
<li><p>Platform Loader and Manager (PLM)</p></li>
<li><p>PS Management (PSM) firmware</p></li>
<li><p>Platform Device Image (PDI)</p></li>
<li><p>ARM trusted firmware</p></li>
<li><p>u-boot</p></li>
<li><p>Device tree blob</p></li>
</ul>
</li>
<li><p><strong>boot.scr</strong>: A u-boot boot script</p></li>
<li><p><strong>image.ub</strong>: U-boot wrapped Linux kernel image</p></li>
<li><p><strong>rootfs.tar.gz</strong>: Compressed root file system tar ball</p></li>
</ul>
</div>
<div class="section" id="create-an-sd-card-image">
<h2>5.3. Create an SD Card Image<a class="headerlink" href="#create-an-sd-card-image" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Create two primary partitions on your SD card:</p>
<ul class="simple">
<li><p>The first partition is the boot partition in FAT32 format.</p></li>
<li><p>The second partition is the root file system in EXT4 format.</p></li>
</ul>
<p>Use the fdisk utility to partition your SD card. The below steps assume your
SD card is device <em>/dev/sdb</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">fdisk</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Delete all existing partitions using the <em>d</em> command.</p></li>
<li><p>Create the first primary partition using the <em>n</em> command followed by <em>p</em>.
Set the size to <em>+100M</em>.</p></li>
<li><p>Change the partition type of partition 1 with the <em>t</em> command. Select type
<em>c</em> which is <em>W95 FAT32 (LBA)</em>.</p></li>
<li><p>Create a second primary partition again using <em>n</em> followed by <em>p</em> and set
the size to <em>+2G</em>.</p></li>
<li><p>Use the <em>w</em> command to write the partition table.</p></li>
</ul>
</li>
<li><p>Format the file systems of the two partitions. The first partition should be
FAT32, the second partition ext4:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkfs</span> <span class="o">-</span><span class="n">t</span> <span class="n">vfat</span> <span class="o">-</span><span class="n">F</span> <span class="mi">32</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb1</span>
<span class="n">sudo</span> <span class="n">mkfs</span> <span class="o">-</span><span class="n">t</span> <span class="n">ext4</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb2</span>
</pre></div>
</div>
</li>
<li><p>Copy the required boot files to partition 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb1</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">card</span>
<span class="n">cd</span> <span class="n">image</span><span class="o">/</span><span class="n">linux</span>
<span class="n">sudo</span> <span class="n">cp</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="n">image</span><span class="o">.</span><span class="n">ub</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">card</span>
<span class="n">sudo</span> <span class="n">umount</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">card</span>
</pre></div>
</div>
</li>
<li><p>Copy and extract the root file system to partition 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb2</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">card</span>
<span class="n">sudo</span> <span class="n">cp</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">card</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">card</span>
<span class="n">sudo</span> <span class="n">tar</span> <span class="n">xfv</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">sudo</span> <span class="n">rm</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="o">-</span>
<span class="n">sudo</span> <span class="n">umount</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">card</span>
</pre></div>
</div>
</li>
</ol>
<p>The SD card image is now ready to be used to boot the device into Linux, see
Section <em>Run the Prebuilt Image</em> for details.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="build-vivado.html" class="btn btn-neutral float-left" title="4. Build the Vivado Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p>
        
        &copy; Copyright 2019, Xilinx

    </p>
  </div>
<!--
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 
-->
</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>